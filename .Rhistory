arch <- drv$download_file("Bases y supervisiones/Bases de datos/2023/BBDD - Base Expedientes DFI 2023.xlsx", dest="here.xlsx")
library(Microsoft365R)
list_sharepoint_sites()
site <- get_sharepoint_site("Grupo Teletrabajo GSF")
drv <- site$get_drive('Documentos')
drv$download_file("Bases y supervisiones/Bases de datos/2023/BBDD - Base Expedientes DFI 2023.xlsx", dest="here.xlsx")
install.packages("xlsx")
library(xlsx)
R -version
R.version
getRversion()
install.packages("installr", dependencies = TRUE)
getRversion()
library(xlsx)
install.packages("openxlsx")
library(openxlsx)
install.packages("readxl")
library(readxl)
df <- read_xlsx(path = "here.xlsx")
View(df)
df <- read_xlsx("here.xlsx")
View(df)
data <- read_excel("file_path"here.xlsx"", skip = 1)
data <- read_excel("here.xlsx", skip = 1)
data <- read_excel("here.xlsx")
as.data.frame(data)
data <- read_excel("here.xlsx")
as.data.frame(data)
drv$load_dataframe("Bases y supervisiones/Bases de datos/2023/BBDD - Base Expedientes DFI 2023.xlsx")
drv$download_file("Bases y supervisiones/Bases de datos/2023/BBDD - Base Expedientes DFI 2023.xlsx", overwrite=TRUE)
df <- read_xlsx("here.xlsx", sheet = "BBDD")
as.data.frame(df)
rm(data)
View(df)
install.packages("Microsoft365R")
library(Microsoft365R)
library(readxl)
library(dplyr)
site <- get_sharepoint_site("Grupo Teletrabajo GSF") # Accede al Sharepoint (la primera vez pedirá usuario y clave, hay que tramitar permiso de administrador con OTI)
drv <- site$get_drive('Documentos') # Dentro del Sharepoint, accede a la carpeta "Documentos"
drv$download_file("Bases y supervisiones/Bases de datos/2023/BBDD - Base Expedientes DFI 2023.xlsx", dest="bd_exp_2023.xlsx") # Descarga la BD seleccionada
df <- read_xlsx("bd_exp_2023.xlsx", sheet = "BBDD", skip=1) # Genera un objeto en R con la información del archivo en excel
as.data.frame(df) # Convierte el objeto en un dataframe
rm(drv, site) # Quitamos los objetos innecesarios del ambiente de trabajo
save(df, file="bd_exp_2023.RData") # Guardar el objeto "df" en un archivo .RData (obsérvese el peso del archivo excel en comparación)
rm(df) # Eliminamos el objeto "df" del ambiente de trabajo
load("bd_exp_2023.RData") # Cargamos el objeto "df" desde el archivo .RData
file.remove("bd_exp_2023.xlsx", "bd_exp_2023.RData") # Elimina los archivos listados
class(df) # Permite verificar el tipo de objeto
dim(df) # Obtiene el número de filas y columnas
nrow(df) # Obtiene el número de filas (observaciones)
ncol(df) # Obtiene el número de columnas (variables)
names(df) # Obtiene los nombres de las columnas del dataframe
str(df) # Muestra nombres de las columnas junto con el tipo de dato que almacenan
summary(df) # Muestra un resumen de la información de cada columna
summary(df$GRUPO_ESTANDARIZADO) #Es posible aplicar summary para una o varias columnas seleccionadas
table(df$Revisor) # Muestra un conteo de los valores de una columna
prop.table(table(df$Revisor)) # Muestra la información de table
f1 <- filter(df, Revisor == "Ivette Sánchez") # Filtra columnas por sus valores (ver el nuevo objeto en el ambiente)
f2 <- df %>% filter(Revisor == "Ivette Sánchez") # Igual al anterior, el signo %>% se denomina pipe y se introduce con el atajo "ctrl + shift + m"
a1 <- df %>% arrange(GRUPO_ESTANDARIZADO) # Cambia el orden de las filas (en este caso, en orden alfabético ascendente)
a2 <- df %>% arrange(desc(GRUPO_ESTANDARIZADO)) # También cambia el orden (en este caso, en orden alfabético descendente)
s1 <- df %>% select('N° de Expediente', Revisor, GRUPO_ESTANDARIZADO, RUC) # Selecciona columnas por sus nombres
sn <- df %>% rename(expediente = 'N° de Expediente', jefe_de_equipo = Revisor, grupo = GRUPO_ESTANDARIZADO, ruc = RUC) # Cambia los nombres de las columnas indicadas
m1 <- s1 %>% mutate(dato_aleatorio = as.numeric(df$RUC) / 2) # Crea nuevas columnas (puede ser en función de la información que se tiene en otra columna)
r1 <- df %>% summarise(media_plazo = mean(df$'Plazo para la tramitación (meses)', na.rm = TRUE)) # Agrupa y resume valores múltiples
str(df$RUC) # Observar que RUC contiene datos del tipo "chr", es decir tipo texto.
df2 <- df %>% mutate(RUC = as.numeric(df$RUC)) # Como el RUC es un número, puede ser formateado como tal
str(df2$RUC) # Ahora el RUC de df2 es un dato tipo "num"
df <- df %>% rename(plazo = 'Plazo para la tramitación (meses)') # Importante cambiar el nombre de la columna, caso contrario puede presentar errores
df %>%
group_by(Revisor) %>%
summarise(media_plazo = mean(plazo, na.rm = TRUE)) # Proporciona la media por agrupamiento
df_r <- df %>%
group_by(Revisor) %>%
summarise(media_plazo = mean(plazo, na.rm = TRUE)) # Proporciona la media por agrupamiento
View(df_r)
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity")
library(ggplot2)
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity")
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(df_r, aes(x="", y=media_plazo, fill=group)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)
ggplot(df_r, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)
ggplot(df_r, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()
ggplot(df_r, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()+
geom_text(aes(y = ypos, label = Revisor), color = "white", size=6) +
scale_fill_brewer(palette="Set1")
df_pie <- dff %>%
arrange(desc(Revisor)) %>%
mutate(prop = media_plazo / sum(df_pie$media_plazo) *100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
ggplot(df_r, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()+
geom_text(aes(y = ypos, label = Revisor), color = "white", size=6) +
scale_fill_brewer(palette="Set1")
df_pie <- df %>%
arrange(desc(Revisor)) %>%
mutate(prop = media_plazo / sum(df_pie$media_plazo) *100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
df_pie <- df %>%
arrange(desc(Revisor)) %>%
mutate(prop = media_plazo / sum(df$media_plazo) *100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
df_pie <- df_r %>%
arrange(desc(Revisor)) %>%
mutate(prop = media_plazo / sum(df$media_plazo) *100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
View(df_pie)
df_pie <- df_r %>%
arrange(desc(Revisor)) %>%
mutate(prop = media_plazo / sum(df_r$media_plazo) *100) %>%
mutate(ypos = cumsum(prop)- 0.5*prop )
View(df_pie)
ggplot(df_pie, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()+
geom_text(aes(y = ypos, label = Revisor), color = "white", size=6) +
scale_fill_brewer(palette="Set1")
ggplot(df_pie, aes(x="", y=prop, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()+
geom_text(aes(y = ypos, label = Revisor), color = "white", size=6) +
scale_fill_brewer(palette="Set1")
ggplot(df_pie, aes(x="", y=prop, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()+
geom_text(aes(y = ypos, label = Revisor), color = "white", size=6) +
scale_fill_brewer(palette="Set1")
ggplot(data, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()
ggplot(df_r, aes(x="", y=media_plazo, fill=Revisor)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void()
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity")
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_segment( aes(x=Revisor, xend=Revisor, y=0, yend=media_plazo), color="skyblue") +
geom_point( color="blue", size=4, alpha=0.6) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
)
df_r[1]
gbarras <- function(df) {
ggplot(df, aes(x=df[1], y=df[2])) +
geom_bar(stat = "identity")
}
gbarras(df_r)
ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity")
}
gbarras <- function(df) {
df_x <- df[1]
gbarras <- function(df) {
df_x <- df[1]
df_y <- df[2]
ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
}
gbarras(df_r)
gbarras <- function(df) {
df_x <- df[1]
df_y <- df[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
return(plot_gbarras)
}
gbarras(df_r)
gbarras(df_r)
gbarras <- function(df) {
df_x <- df[1]
df_y <- df[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
print(plot_gbarras)
}
gbarras(df_r)
exit()
ffdfd
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_segment( aes(x=Revisor, xend=Revisor, y=0, yend=media_plazo), color="skyblue") +
geom_point( color="blue", size=4, alpha=0.6) +
theme_light() +
coord_flip() +
theme(
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.ticks.y = element_blank()
)
View(gbarras)
View(gbarras)
library(Microsoft365R)
library(readxl)
gbarras(df_r)
gbarras <- function(df) {
df_x <- df[1]
df_y <- df[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
print(plot_gbarras)
}
gbarras(df_r)
gbarras <- function(df) {
df_x <- df[1]
df_y <- df[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
print(df_x)
}
gbarras(df_r)
df_r$1
gbarras <- function(df) {
df %>% rename(x=df[1], y=df[2])
plot_gbarras <- ggplot(df, aes(x=x, y=y) +
geom_bar(stat = "identity"))
print(df_x)
}
gbarras(df_r)
df_x <- names(df_r)[1]
print(df_x)
gbarras <- function(df) {
df_x <- names(df)[1]
df_y <- names(df)[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
print(df_x)
}
gbarras(df_r)
gbarras <- function(df) {
df_x <- names(df)[1]
df_y <- names(df)[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
}
df_x <- names(df_r)[1]
df_y <- names(df_r)[2]
plot_gbarras <- ggplot(df, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
plot_gbarras <- ggplot(df_r, aes(x=df_x, y=df_y) +
geom_bar(stat = "identity"))
gbarras <- function(df) {
x <- df[1]
y <- df[2]
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
}
gbarras(df_r)
x <- df_r[1]
y <- df_R[2]
data <- data.frame(x, y)
y <- df_r[2]
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
View(data)
View(data)
View(x)
x <- c(df_r[1])
print
print(x)
x <- c(df_r[1])
y <- c(df_r[2])
data <- data.frame(x, y)
View(data)
data <- df_r %>% mutate(x = df_r[1], y = df_r[2])
View(data)
x <- as.vector(df_r[1])
y <- as.vector(df_r[2])
data <- data.frame(x, y)
View(data)
data <- data %>% mutate(x = x, y = y)
View(data)
x <- df_r[1]
y <- df_r[2]
data <- data.frame(x, y)
View(data)
data <- data %>% mutate(x = x, y = y)
ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
data <- data %>% mutate(x = x, y = y)
View(data)
x <- pull(df_r, names(df_R)[1])
x <- pull(df_r, names(df_r)[1])
y <- pull(df_r, names(df_r)[2])
data <- data.frame(x, y)
View(data)
gbarras <- function(df) {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
}
gbarras(df_r)
ggplot(data, aes(x=x, y=y) +
geom_bar(stat = "identity"))
View(data)
j <- pull(df_r, names(df_r)[1])
k <- pull(df_r, names(df_r)[2])
data <- data.frame(j, k)
ggplot(data, aes(x=j, y=k) +
geom_bar(stat = "identity"))
View(data)
ggplot(df_r, aes(x=Revisor, y=media_plazo)) +
geom_bar(stat = "identity")
ggplot(data, aes(x=j, y=k)) +
geom_bar(stat = "identity")
gbarras <- function(df) {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")
}
gbarras(df_r)
gbarras <- function(df) {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")
return(plot_gbarras)
}
gbarras(df_r)
gbarras <- function(df, a, b) {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")+
xlab(a)+
ylab(b)
return(plot_gbarras)
}
gbarras(df_r, juan, sofia)
gbarras(df_r, "juan", "sofia")
gbarras <- function(df, a="x", b="y") {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")+
xlab(a)+
ylab(b)
return(plot_gbarras)
}
gbarras(df_r)
gbarras <- function(df, a="x", b="y") {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")+
xlab(a)+
ylab(b)
return(plot_gbarras)
}
gbarras(df_r, "juan", "sofia")
gbarras(df_r)
gbarras <- function(df, a="", b="") {
x <- pull(df, names(df)[1])
y <- pull(df, names(df)[2])
data <- data.frame(x, y)
plot_gbarras <- ggplot(data, aes(x=x, y=y)) +
geom_bar(stat = "identity")+
xlab(a)+
ylab(b)
return(plot_gbarras)
}
gbarras(df_r)
